
////////////////////////////////////////////////////////////////////////////////
// K

$color-accent: #0b9a9a
$color-accent2: #057d7d
$color-background: #f7f7f7
$color-header-background-left: $color-accent
$color-header-background-right: $color-accent2
$color-sidebar-background-active: #44444b
$color-sidebar-background: #33333b
$color-sidebar-background2: #2d2d31
$color-sidebar-background3: #1c1c22
$color-splash: #085b5b
$color-heading: #000
$color-text: #333
$color-success: #4c4
$color-error: #c44

$header-height: 12rem
$header-overdraw: 20rem
$logo-size: 7.2em
$sidebar-padding: 2.5rem
$sidebar-width: 28rem
$main-padding: 4rem
$main-max-width: 65rem
$repl-left-gutter: 12rem

$font-title: 'malaga-narrow', "Helvetica Neue", Helvetica, Arial, sans-serif
$font-heading: malaga, "Helvetica Neue", Helvetica, Arial, sans-serif
$font-body: ratio, "Helvetica Neue", Helvetica, Arial, sans-serif
$font-monospace: menlo, monaco, inconsolata, consolas, monospace

$z-mobile-toc: 1
$z-toc-api-object: 1
$z-api-find: 2
$z-toc-toplevel-entry: 3
$z-header-base: 100
$z-header: 101
$z-repl: 150
$z-flyout: 200

$icon-arrow-right: '\e900'
$icon-chevron-down: '\e90a'
$icon-chevron-right: '\e90b'
$icon-delete: '\e901'
$icon-close: '\e902'
$icon-close-small: '\e90c'
$icon-close-circle: '\e903'
$icon-pencil: '\e904'
$icon-replay-all: '\e905'
$icon-pin: '\e906'
$icon-play: '\e907'
$icon-back-arrow: '\e908'
$icon-window: '\e909'

$ease-extreme-out: cubic-bezier(.05, .9, 0, 1)


////////////////////////////////////////////////////////////////////////////////
// UTIL

@mixin fill($buffer: 0)
  bottom: 0
  left: 0
  position: absolute
  right: 0
  top: 0

@mixin reify
  content: ''
  display: block


////////////////////////////////////////////////////////////////////////////////
// COMMON

@mixin custom-scrollbar($color-thumb: $color-accent, $color-gutter: rgba(0, 0, 10, 0.8))
  &::-webkit-scrollbar
    background: $color-gutter
    width: 0.9em

  &::-webkit-scrollbar-thumb
    background: $color-thumb

@mixin icon($which: null)
  @if $which
    content: $which
  font-family: 'icons' !important
  -webkit-font-smoothing: antialiased
  -moz-osx-font-smoothing: grayscale
  font-style: normal
  font-variant: normal
  font-weight: normal
  line-height: 1
  speak: none
  text-transform: none

@mixin no-appearance
  background: none
  border: none
  margin: 0
  outline: none
  padding: 0


////////////////////////////////////////////////////////////////////////////////
// IMPORTS / EXTERNS

@import '../node_modules/codemirror/lib/codemirror'
@import '../node_modules/janus-inspect/lib/inspect'

@font-face
  font-family: 'icons';
  src: url('/assets/icons.eot?b')
  src: url('/assets/icons.eot?b#iefix') format('embedded-opentype'), url('/assets/icons.ttf?b') format('truetype'), url('/assets/icons.woff?b') format('woff'), url('/assets/icons.svg?b#icomoon') format('svg')
  font-weight: normal
  font-style: normal


////////////////////////////////////////////////////////////////////////////////
// RESET

html, body, div, span, applet, object, iframe, h1, h2, h3, h4, h5, h6, p,
blockquote, pre, a, abbr, acronym, address, big, cite, code, del, dfn, em,
font, img, ins, kbd, q, s, samp, small, strike, strong, sub, sup, tt, var,
b, u, i, center, dl, dt, dd, ol, ul, li, fieldset, form, label, legend,
table, caption, tbody, tfoot, thead, tr, th, td
  background: transparent
  border: 0
  margin: 0
  outline: 0
  padding: 0
  vertical-align: baseline

html
  color: $color-text
  font-family: $font-body
  font-size: 62.5%

body
  background-color: $color-sidebar-background

ul, ol
  list-style-type: none


////////////////////////////////////////////////////////////////////////////////
// GLOBAL

.hide
  display: none !important


////////////////////////////////////////////////////////////////////////////////
// LAYOUT

////////////////////////////////////////
// LAYOUT: base

header
  color: #fff
  left: 0
  position: fixed
  top: 0
  right: 0
  z-index: $z-header-base

  &:before, &:after
    @include reify
    position: absolute
    transform: skewY(-3deg)
    transform-origin: left center

  &:before
    background: $color-header-background-left
    box-shadow: 0 0 1.2em rgba(0, 0, 0, 0.8)
    left: 0
    height: $header-height + $header-overdraw + 2rem
    top: -1.3rem - $header-overdraw
    width: $sidebar-width
    z-index: $z-header

  &:after
    background: $color-header-background-right
    height: $header-height + $header-overdraw
    left: $sidebar-width
    right: 0
    top: -$header-overdraw

  .header-left
    padding: 3em
    position: absolute
    z-index: $z-header

  .header-right
    left: $sidebar-width
    padding: $main-padding
    position: absolute
    z-index: $z-header

  #show-toc
    @include no-appearance
    cursor: pointer
    display: none
    position: absolute
    right: 3em
    top: 4.3em
    z-index: $z-header

    &:after
      $size: 0.4em
      @include reify
      border: $size solid transparent
        bottom: none
        top-color: #fff
      left: calc(100% + 0.5em)
      position: absolute
      top: calc(50% - #{$size / 2})
      transition: transform 0.2s

    .icon
      $height: 0.9em
      $width: 1.4em
      border-bottom: 2px solid #fff
      border-top: 2px solid #fff
      height: $height
      width: $width

      &:before
        @include reify
        border-bottom: 2px solid #fff
        height: calc(#{$height / 2} - 1px)
        width: $width

  #logo
    border: 3px solid rgba(255, 255, 255, 0.1)
    border-radius: 9999px
    float: left
    height: $logo-size
    margin-right: 1.5em
    margin-top: -0.7em
    width: $logo-size

    svg path
      fill: #fff

  h1
    float: left
    font-family: $font-title
    font-size: 4em
    font-weight: 400
    line-height: 1em

  a
    border-bottom: 1px dotted rgba(255, 255, 255, 0.2)
    color: #fff
    text-decoration: none
    transition: 0.1s border-color

    &:hover
      border-bottom-color: #fff

  nav
    font-family: $font-title
    font-size: 2em

    a
      margin-right: 1em
      text-transform: lowercase

#left
  @include fill
  background: $color-sidebar-background
  box-shadow: 0 -0.6em 0.6em rgba(0, 0, 0, 0.45)
  position: fixed
  right: auto
  width: $sidebar-width

  nav
    @include fill
    @include custom-scrollbar
    overflow-x: hidden
    overflow-y: auto
    top: $header-height - 1rem

    > ul
      padding-top: $main-padding

  .toc-entry
    $vpadding: 0.8rem
    $indent: 1.5rem

    &.active
      > a, > a:hover
        background: $color-accent

    a
      border-bottom: 1px solid $color-sidebar-background2
      color: #fff
      display: block
      font-family: $font-title
      font-size: 2.2rem
      padding: $vpadding $sidebar-padding
      text-decoration: none
      transition: 0.2s background

      &:hover
        background: $color-sidebar-background-active
        transition: none

    > a
      // get the API Reference header to show over the 
      position: relative
      z-index: $z-toc-toplevel-entry

    ul
      padding-bottom: 1.5rem

    .toc-entry
      a
        background: #2d2d31
        border-bottom-color: $color-sidebar-background
        font-family: $font-body
        font-size: 1.5rem
        padding: $vpadding 1rem
          left: $sidebar-padding + $indent

        // TODO: these layered overrides are incredibly irritating.
        &:hover
          background: $color-sidebar-background-active

      &.active
        a, a:hover
          background: $color-accent

      .toc-entry a
        padding-left: $sidebar-padding + ($indent * 2)

    .toc-children
      display: none
    &.prefix .toc-children
      display: block

  .api-browser
    background: $color-sidebar-background3
    color: #fff

    .api-find
      $overdraw: 2rem
      background: $color-sidebar-background
      border-bottom: 1px solid $color-accent2
      margin-top: -$overdraw
      padding-top: $overdraw
      position: sticky
      top: 0
      z-index: $z-api-find

      input
        @include no-appearance
        background: $color-sidebar-background2
        color: #fff
        font-family: $font-body
        font-size: 1.3em
        padding: 0.8em 1em
          left: $sidebar-padding
        width: 100%

      button
        $offset: 0.6rem
        $size: 1.8em
        background: none
        border: none
        bottom: $offset
        color: #fff
        display: block
        font-size: 2em
        position: absolute
        right: $offset

    .api-sections
      padding-top: 1em

    .api-section
      .api-section-header
        @include no-appearance
        color: #fff
        padding: 0.9em 0 1rem $sidebar-padding
        position: relative
        text-align: left
        width: 100%

        &:before
          $tri-size: 0.4em
          content: ''
          border: $tri-size solid transparent
            bottom: none
            top-color: #fff
          left: 1em
          position: absolute
          top: 1.4em
          transform: rotate(-90deg)

        h2
          font-family: $font-heading
          font-size: 1.2em
          font-weight: bold

      .api-section-objects
        display: none

      &.expanded
        .api-section-header:before
          transform: rotate(0deg)
        .api-section-objects
          display: block

    .api-object
      .api-object-name
        background: $color-sidebar-background3
        border-bottom: 0
        border-top: 3px solid $color-sidebar-background
        box-shadow: 0 0.3rem 0 transparentize($color-sidebar-background3, 0.6)
        font-family: $font-monospace
        font-size: 1.6em
        font-weight: normal
        padding-left: $sidebar-padding
        position: sticky
        top: 5.5rem
        z-index: $z-toc-api-object

        &:hover
          background: $color-sidebar-background-active

      ul
        padding-bottom: 0

      .api-object-sections
        display: none

      &.navigated .api-object-name
        background: $color-accent

      &.navigated, &.match
        .api-object-sections
          display: block

    .api-objsection
      padding-bottom: 0.8em

      .api-objsection-name
        border-bottom: none
        color: #aaa
        font-family: $font-body
        font-size: 1.2em
        padding: 0.5em 0 0.25em $sidebar-padding

        &:hover
          background: inherit
          text-decoration: underline

    .api-objsection-members li:last-child .api-member-name
      border-bottom: none

    .api-member
      position: relative

      .api-member-name
        font-family: $font-monospace
        font-size: 1.2em
        padding: 0.5em
          left: $sidebar-padding

      .api-member-return-type
        background: #111
        border-radius: 0.15em
        font-family: $font-monospace
        padding: 0.3em 0.4em 0.2em
        pointer-events: none
        position: absolute
        right: 0.8em
        top: 0.5em

    &.finding
      .api-object, .api-objsection, .api-member
        display: none
        &.match
          display: block

#main
  background: $color-background
  margin-left: $sidebar-width
  min-height: calc(100vh - #{2 * $main-padding + $header-height})
  padding: $main-padding
    top: $header-height + $main-padding

#repl .repl
  display: none

#repl.activated
  $repl-width: 40vw
  $repl-full-width: 70vw

  .repl
    animation-duration: 0.3s
    animation-name: "right-motion"
    animation-timing-function: $ease-extreme-out
    animation-iteration-count: 1
    background: rgba(244, 244, 244, 0.98)
    bottom: 0
    box-shadow: inset 16.4rem 0 0 #eee, -5px 0 0 rgba(0, 0, 0, 0.45)
    display: block
    position: fixed
    right: -1 * $repl-width
    top: 0
    transition: width 0.2s $ease-extreme-out
    width: $repl-width
    z-index: $z-repl

    &.has-pins
      right: -1 * $repl-full-width
      width: $repl-full-width

  &.active .repl
    animation-name: "left-motion"
    right: 0


#flyouts .flyout
  position: absolute
  z-index: $z-flyout

footer
  display: none // for now


////////////////////////////////////////
// LAYOUT: lesser widths

@media (max-width: 1260px)
  #main
    .sample-code
      float: none

    .sample-result
      padding-top: 3em


@media (max-width: 810px)
  header
    &:before
      box-shadow: 0 0 1.2em rgba(0, 0, 0, 0)
      width: 85rem
    &:after
      display: none
    .header-right
      left: 22rem

    #show-toc
      display: block

  #left
    box-shadow: 0 0 0.6em rgba(0, 0, 0, 0)
    left: 100vw
    transform: translateX(0)
    transition: transform 0.3s ease-in
    z-index: $z-mobile-toc

  #main
    margin-left: 0
    transition: filter 0.1s

  .show-toc
    #show-toc:after
      transform: rotate(-90deg)

    #left
      box-shadow: 0 0 1.4em rgba(0, 0, 0, 0.6)
      transform: translateX(#{-1 * $sidebar-width})
      transition: transform 0.3s $ease-extreme-out
    #main
      filter: blur(0.2em)

@media (max-width: 600px)
  header .header-right
    left: $logo-size
    padding: 6em
    top: 1.5em

    nav
      font-size: 1.5em


////////////////////////////////////////
// LAYOUT: flyouts

.flyout
  .janus-inspect-panel
    min-width: 30em

    &.janus-inspect-varying
      min-width: 40em



////////////////////////////////////////////////////////////////////////////////
// CONTENT

////////////////////////////////////////
// CONTENT: main article

.article
  h1, h2
    color: $color-heading
    font-family: $font-heading
    font-weight: 500
    letter-spacing: -0.02em
    margin-bottom: 0.4em
    padding-top: 0.8em
  h1
    font-size: 3em
  h2
    font-size: 2em

  h1, h2, h3
    a.anchor
      $dist: $header-height + $main-padding
      display: block
      margin-top: -$dist
      padding-top: $dist
      pointer-events: none

    a.self-link
      color: #ccc
      margin-left: 0.8rem
      visibility: hidden

      &:hover
        color: #666

    &:hover a.self-link
      visibility: visible

  p
    font-size: 1.6em
    line-height: 1.3em
    margin-bottom: 1.5em
    max-width: $main-max-width

    &.splash
      color: $color-splash
      font-family: $font-heading
      font-size: 3em
      letter-spacing: -0.02em

      .splash-two
        color: $color-accent2

    + ul
      margin-top: -1em

  > ul, > ol
    $padding-left: 2em
    max-width: calc(#{$main-max-width} - #{$padding-left})
    padding-bottom: 1em
    padding-left: $padding-left

    ul, ol
      padding-left: 1.2em
      padding-top: 0.5em

    > li
      font-size: 1.6em
    li
      padding-bottom: 0.5em

      ul, ol
        li:last-child
          padding-bottom: 0

  > ul, > ul ul, > ol ul
    list-style-type: circle

  > ol, > ol ol, > ul ol
    list-style-type: decimal

  p, > ul, > ol
    a
      border-bottom: 1px dotted $color-accent
      color: $color-accent
      text-decoration: none

      &:hover, &:active, &:focus
        border-bottom-style: solid

      &:visited
        color: $color-accent2

    code
      background-color: #eee
      font-size: 1.2em

  blockquote
    background-color: #f0f0f0
    border-left: 0.6em solid #ddd
    margin-bottom: 2.5em
    max-width: 60rem
    padding: 1.3em
      left: 1.6em

    p, h1
      margin: 0
      padding: 0

    h1
      font-size: 1.8em
      padding-bottom: 0.3em

    p
      font-size: 1.4em
      + p
        padding-top: 0.8em

    code
      background-color: #ddd

    pre
      font-size: 1.6em
      padding: 0.4em 0
      code
        background-color: transparent

  .feature // TODO: move this out.
    svg
      $size: 8em
      float: left
      height: $size
      margin-right: 1.5em
      margin-top: 1em
      width: $size

      path
        fill: #aaa

    p
      margin-bottom: 0.5em

    + p
      margin-top: 2em

    h2 a.self-link
      display: none

////////////////////////////////////////
// CONTENT: API reference

.apiref
  h3
    background-color: #eee
    border-top: 2px solid #bbb
    box-shadow: 0 0.2em 0 #ebebeb inset
    font-family: $font-monospace
    font-size: 2em
    margin: 0 #{-$main-padding}
    padding: 0.8em $main-padding

    &.level-class.type-method
      border-top-color: #92a
    &.level-instance.type-method
      border-top-color: $color-accent

  h4
    background-color: #eee
    border-top: 1px solid #e4e4e4
    font-family: $font-monospace
    font-size: 1.3em
    margin: 0 #{-$main-padding} 1.5em
    padding: 1em $main-padding

    .annotation
      background: $color-accent2
      border-radius: 0.2em
      color: #fff
      font-size: 0.8em
      font-weight: normal
      margin-left: 1em
      padding: 0.3em 0.4em 0.2em

  h3 + h4
    border-top: none
    margin-top: -0.7em
    padding-top: 0

  h4 + h4
    border-top: none
    margin-top: -1.8em

  h3 + p
    padding-top: 1em

  .sample
    background-color: #f4f4f4
    border: none
    margin-top: -0.8em
    padding: 1.4em $main-padding 1em

    .sample-result
      &:before
        display: none

      .eval-success
        font-family: $font-monospace

        > .janus-list > li
          &:first-child
            padding-top: 0.3em
          &:last-child
            padding-bottom: 0.3em

          > .janus-inspect-list.janus-inspect-entity > .entity-content > .list-values > ul > li
            display: block
            padding-left: 1em

            &:first-child:last-child
              display: inline
              padding-left: 0

      .janus-inspect-entity .entity-content
        margin-left: -0.5em

    .sample-error
      margin-bottom: -1em
      padding-top: 1em


////////////////////////////////////////////////////////////////////////////////
// COMPONENTS

.sample
  $border-color: #e4e4e4

  background-color: #f0f0f0
  border-bottom: 1px solid $border-color
  border-top: 1px solid $border-color
  box-shadow: 0 0 0 0 transparentize($color-error, 0.92) // for the transition
  margin: 0.5em #{-$main-padding} 2em
  overflow: hidden
  padding: 2em $main-padding
  transition: 0.2s border-color, 0.2s box-shadow

  .sample-code
    float: left
    min-width: 65%

    .CodeMirror
      background: transparent
      font-family: $font-monospace
      font-size: 1.2em
      height: auto

      .CodeMirror-scroll
        height: auto

    .code-static
      padding: 0.4em

      code
        font-family: $font-monospace
        font-size: 1.2em

  .sample-result
    font-size: 1.2em
    overflow: hidden

    &:before
      content: 'Result'
      display: block
      font-family: $font-heading
      font-size: 1.5em

    .eval-success > .janus-list > li
      border-bottom: 1px dotted #999
      padding: 1em 0
      &:last-child
        border-bottom: none

    .janus-inspect-panel.janus-inspect-varying
      font-size: 0.8333em

      .title .className
        display: none

    .exception
      position: relative

      .exception-expando
        bottom: 0
        position: absolute
        right: 0

    h1
      font-size: 1.8em

  &.noexec .sample-result,
  &.custom-view.error .sample-result
    display: none

  .sample-error
    clear: both
    max-height: 0
    margin: 0 -4em -2em
    overflow: hidden
    padding-top: 2em
    transition: 0.6s max-height

    .exception
      background-color: $border-color
      color: #fff
      padding: 1.2em 4em 1em
      transition: 0.2s background-color

      .exception-expando
        display: none

  &.error
    border-color: $color-error
    box-shadow: 0 0 0 4px transparentize($color-error, 0.92)

    .sample-result:before
      content: 'Last Successful Result'

    .sample-error
      max-height: 9em

      .exception
        background-color: $color-error

.context-view .context-switcher button
  @include no-appearance
  position: absolute
  right: 0
  top: 0

  &:after
    @include icon($icon-window)
    font-size: 1.2em

  &:hover:after
    color: $color-accent

.CodeMirror.cm-s-default
  .CodeMirror-activeline-background
    background: #f7f7f7
  .cm-def
    color: #007ec7
  .cm-keyword
    color: #037d7d
  .CodeMirror-nonmatchingbracket
    background: #ecc
    color: inherit
  .cm-property
    color: #666
  .cm-string, .cm-string-2
    color: #0c820a
  .cm-trailingspace
    background: #e3e3e3
  .cm-variable
    color: #7c00bb

  &.CodeMirror-focused
    .CodeMirror-matchingbracket
      background: #d7d7d7
      color: inherit

.exception
  animation-duration: 1s
  animation-timing-function: $ease-extreme-out
  animation-iteration-count: 1

  .exception-message
    font-family: $font-monospace
    font-size: 1.2em

  .exception-stack
    li ~ li
      display: none

    a
      color: #fff


  .exception-expando button
    @include no-appearance
    padding: 0.2em

    &:before
      $size: 7px
      @include reify
      border-right: 2px solid #fff
      border-bottom: 2px solid #fff
      cursor: pointer
      height: $size
      transform: rotate(45deg)
      transition: 1s transform $ease-extreme-out
      width: $size

    &.checked:before
      transform: rotate(-135deg)

  &.exception-name-SyntaxError
    .exception-stack, .exception-expando
      display: none

  &.has-expanded 
    animation-name: contract-margin

  &.expanded
    animation-name: expand-margin

    .exception-stack li ~ li
      display: block

.view
  .view-error.has-error
    background-color: $color-error
    color: #fff
    margin-top: 1em
    padding: 1em
      top: 0.9em

    &:before
      content: 'Runtime Error'
      font-weight: bold

    .exception-message
      padding: 0.1em 0 0.5em


////////////////////////////////////////
// COMPONENTS: repl

$repl-chrome-padding: 1em
$repl-chrome-width: 2.4em
$repl-chrome-outer-width: (2 * $repl-chrome-padding) + $repl-chrome-width
$repl-chrome-color-fg: #666
$repl-chrome-color-bg: #d4d4d4
$pin-color-bg: #ddd
$pin-chrome-padding: 0.4em
$pin-chrome-width: 1.6em
$pin-chrome-outer-width: (2 * $pin-chrome-padding) + $pin-chrome-width

.repl

  .repl-chrome
    background: $repl-chrome-color-bg
    bottom: 0
    left: 0
    padding: $repl-chrome-padding
    position: absolute
    top: 0
    width: $repl-chrome-width

    button
      @include no-appearance
      margin-bottom: 1em
      padding: 0.1em
      &:before
        @include icon($icon-close-circle)
        color: $repl-chrome-color-fg
        font-size: 2em

    h2
      color: $repl-chrome-color-fg
      cursor: default
      font-family: $font-monospace
      margin-bottom: 4em
      margin-left: 1.45em
      text-align: center
      text-transform: lowercase
      transform: rotate(90deg)
      transform-origin: left top
      white-space: nowrap

  .repl-main
    @include custom-scrollbar(#777, #ccc)
    bottom: 0
    cursor: text
    left: $repl-chrome-outer-width
    overflow-x: auto
    overflow-y: auto
    position: absolute
    right: 0
    top: 0

  .repl-statement
    border-bottom: 1px dotted #ddd
    overflow: hidden

  .repl-pins
    @include fill
    background-color: $pin-color-bg
    border-left: 1px solid #c4c4c4
    display: none
    left: auto

    .repl-chrome
      border-right: 1px dotted #e6e6e6

      button:before
        content: $icon-close

    .repl-pins-list
      margin-left: $repl-chrome-outer-width
      overflow-y: auto

    .janus-inspect-panel .panel-title .janus-inspect-pin
      display: none

  &.has-pins
    $pins-width: 45em

    .repl-main
      right: $pins-width

    .repl-pins
      box-shadow: #{$repl-chrome-outer-width + $pin-chrome-outer-width} 0 0 $repl-chrome-color-bg inset
      display: block
      width: $pins-width

  li:last-child .repl-statement
    border-bottom: none

  .CodeMirror
    background: transparent
    font-family: $font-monospace
    font-size: 1.2em
    height: auto

    .CodeMirror-scroll
      height: auto

.repl-statement
  $placeholder-color: #888
  padding: 0.8em 1.3em
    left: 0.8rem + $repl-left-gutter
  position: relative

  .repl-statement-name
    float: left
    font-family: $font-monospace
    font-size: 1.4em
    margin-left: -1 * $repl-left-gutter
    padding-top: 0.15em
    width: $repl-left-gutter

    input
      @include no-appearance
      font-family: $font-monospace
      margin-right: 0.4em
      text-align: right
      width: calc(100% - 3em)
      &::placeholder
        color: $placeholder-color

    &:after
      color: $placeholder-color
      content: '>'

  &.named .repl-statement-name
    input
      color: $color-text

    &:after
      color: $color-text
      content: '='

  .repl-statement-status
    $size: 0.6em
    border-radius: $size
    float: left
    height: $size
    margin: 0.5em
      right: 1em
    width: $size

    &.status-success
      background-color: $color-success
    &.status-error
      background-color: $color-error
    &.no-status
      background-color: #ccc

  .repl-statement-result
    position: relative

    .janus-literal
      font-size: 1.2em

    .entity-title, .entity-content:before, .entity-content:after
      font-family: $font-monospace
      font-size: 1.2em

    .entity-content .janus-literal,
    > .eval-success > .janus-list > li > .janus-literal
      font-family: $font-monospace

    .janus-inspect-panel
      clear: left

.pin
  overflow: hidden
  position: relative

  .pin-chrome
    @include fill
    padding: 1em $pin-chrome-padding
    right: auto
    width: $pin-chrome-width

    button
      @include no-appearance
      &:before
        @include icon
        color: $repl-chrome-color-fg
        font-size: 1.6em

    .pin-remove:before
      content: $icon-close-small

    .pin-expand button
      &:before
        content: $icon-chevron-right
      &.checked:before
        content: $icon-chevron-down

  .pin-contents
    animation-duration: 1s
    animation-name: 'contract-margin'
    animation-iteration-count: 1
    animation-timing-function: $ease-extreme-out
    margin-left: $pin-chrome-outer-width
    max-height: 3em
    padding: 1em

  &.expanded .pin-contents
    animation-name: 'expand-margin'
    max-height: none

.flyout
  box-shadow: 0 0.3em 0.5em rgba(0, 0, 0, 0.12)

////////////////////////////////////////
// COMPONENTS: inspect

.janus-inspect-entity
  .entity-title
    cursor: default

.janus-inspect-panel
  background-color: #fff
  border-radius: 0.2em
  font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif
  position: relative

  .panel-title
    background-color: $color-accent
    border-radius: 0.2em 0.2em 0 0
    color: #fff
    font-size: 1.3em
    font-weight: bold
    padding: 0.5em
      bottom: 0.6em

    .janus-inspect-pin
      @include no-appearance
      display: block
      right: 0.6em
      position: absolute
      top: 0.85em
      z-index: 1

      &:before
        @include icon($icon-pin)
        color: #fff
        font-size: 1.2em

  .panel-content
    padding: 1em

  .panel-sidebar
    $sidebar-width: 14em
    @include fill
    left: auto
    width: $sidebar-width

    .panel-sidebar-title
      background-color: $color-accent2
      border-top-right-radius: 0.2em
      color: #fff
      font-size: 1.1em
      font-weight: bold
      padding: 0.8em

    .panel-sidebar-content
      @include fill
      background-color: #eee
      overflow-x: hidden
      overflow-y: auto
      top: 3em

    ~ .panel-content
      margin-right: $sidebar-width

.janus-inspect-kvPair
  padding-bottom: 0.15em
  .kvPair-valueBlock
    line-height: 1.4em

.janus-inspect-varying.janus-inspect-panel
  .varying-snapshot
    background-color: #fadd00 // TODO: copied from -inspect
    border-radius: 0.2em
    color: $color-text
    font-size: 0.8em
    margin-left: 0.3em
    padding: 0.2em 0.4em
      right: 1.8em

    .varying-snapshot-close
      color: $color-text
      display: inline-block
      font-size: 1.6em
      line-height: 0.9em
      margin-left: 0.2em
      overflow: hidden
      position: absolute
      text-decoration: none
      width: 0.6em

      &:before
        content: '×'
        padding-right: 1em

  .panel-content > .varying-tree
    padding-top: 0.4em

  .varying-inert
    color: #777
    padding-bottom: 0.8em

    a
      color: $color-accent2

  .varying-reactions
    li:nth-child(2n)
      background-color: #f7f7f7

    .janus-list-selectItem
      position: relative

      &.checked
        background-color: #fff
        box-shadow: -0.2em 0 0 $color-accent inset

      > button
        @include fill
        cursor: default
        opacity: 0
        width: 100%

      .reaction
        padding: 0.3em 0.6em

.varying-delta .separator:before
  @include icon($icon-arrow-right)


////////////////////////////////////////
// COMPONENT: thinker

$thinker-offset: 4em
$thinker-angle: 0.436rad
$thinker-size: 7em
$thinker-effect-height: 60em
#thinker
  background: radial-gradient(#ddd, #d4d4d4)
  bottom: $thinker-offset
  clip-path: circle()
  height: $thinker-size
  opacity: 0
  pointer-events: none
  position: fixed
  right: $thinker-offset
  transition: 0.5s opacity
  width: $thinker-size

  &.thinking
    opacity: 0.85
    transition-delay: 0.3s // wait a moment before showing

    div:before, div:after
      animation-name: thinker

.thinker-1, .thinker-2, .thinker-3, .thinker-4
  height: 100%
  overflow: hidden
  position: absolute

  &:before, &:after
    animation-iteration-count: infinite
    animation-timing-function: linear
    content: ''
    display: block
    height: $thinker-effect-height
    position: absolute
    width: 100%

  $transparent: transparentize($color-background, 1)
  &:before
    animation-duration: 2s
    background: linear-gradient($transparent, $color-background, $transparent)

  &:after
    animation-duration: 0.8s
    background: linear-gradient($transparent, transparentize($color-background, 0.6), $transparent)

.thinker-1, .thinker-2
  top: $thinker-size * -0.12
  width: $thinker-size * 0.1265

.thinker-1
  left: $thinker-size * 0.228
  transform: rotate($thinker-angle)
  &:after
    animation-delay: 0.25s;

.thinker-2
  right: $thinker-size * 0.24
  transform: rotate(-1 * $thinker-angle)
  &:before
    animation-delay: 0.1s;
  &:after
    animation-delay: 0.3s;

.thinker-3, .thinker-4
  top: $thinker-size * 0.07
  width: $thinker-size * 0.088

.thinker-3
  left: $thinker-size * 0.317
  transform: rotate(-1 * $thinker-angle)
  &:before
    animation-delay: 0.2s;
  &:after
    animation-delay: 0.2s;

.thinker-4
  right: $thinker-size * 0.33
  transform: rotate($thinker-angle)
  &:before
    animation-delay: 0.4s;


////////////////////////////////////////////////////////////////////////////////
// KEYFRAMES
// this is at the bottom because the vim sass highlighting freaks out about it.

@keyframes contract-margin
  from
    margin-bottom: 12px
  to
    margin-bottom: 0

@keyframes expand-margin
  from
    margin-bottom: -12px
  to
    margin-bottom: 0

@keyframes thinker
  from
    top: -1 * $thinker-effect-height - $thinker-size
  to
    top: $thinker-size

@keyframes left-motion
  from
    transform: translateX(60px)
  to
    transform: translateX(0)

@keyframes right-motion
  from
    transform: translateX(-60px)
  to
    transform: translateX(0)

